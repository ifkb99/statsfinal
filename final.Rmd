---
title: "Final Project"
author: "Ian Baker, Loughlin Claus, Zack Schieberl"
date: "12/7/2019"
geometry: margin=2cm
output: pdf_document
---

## Pledge
I pledge my honor that I have abided by the Stevens Honor System
- Ian Baker, Loughlin Claus, Zack Schieberl

## 11.53

```{r fig.height=3, fig.width=3.5, fig.show='hold'}
cheese <- as.matrix(read.csv2("cheese.csv", header = TRUE, sep = ","))

cheeseCols <- colnames(cheese)
for (col in cheeseCols) {
  cur <- as.numeric(cheese[, col])
  # mean, median, sd, iqr
  out <- c(paste("Type:", col), paste("Mean:", round(mean(cur), 2)),
           paste("Median:", round(median(cur), 2)), paste("SD:", round(sd(cur), 2)),
           paste("IQR:", round(IQR(cur), 2)))
  print(format(out, justify = "left", trim = TRUE))
  # stemplot
  stem(cur)
  # normal quantile plot
  qqnorm(cur, main = col)
  qqline(cur)
}
```

While H2S and Taste have some right skew, and Acetic has two peaks, the data all appears to be relatively normal. There are no outliers in the data.

## 11.54

```{r fig.height=3, fig.width=3.5, fig.show='hold'}
for (col in cheeseCols) {
  colIdx <- grep(col, cheeseCols)
  col1Data <- as.numeric(cheese[, col])
  for (col2 in cheeseCols) {
    if (colIdx < grep(col2, cheeseCols)) {
      col2Data <- as.numeric(cheese[, col2])
      plot(col1Data, col2Data, xlab = col, ylab = col2)
      correl <- cor.test(col1Data, col2Data)
      cat("Correlation between", col, "and", col2, "is:", correl$estimate,
          "with a p-value of", correl$p.value, "\n")
    }
  }
}
```

## 11.55

```{r}
tasteCol <- as.numeric(cheese[, "taste"])
aceticCol <- as.numeric(cheese[, "acetic"])
tasteVsAcetic <- lm(tasteCol ~ aceticCol, data.frame(cheese))
plot(aceticCol, tasteCol, xlab = "Acetic", ylab = "Taste")
abline(tasteVsAcetic)
```

```{r fig.height=3, fig.width=3.5, fig.show='hold'}
tVsAResiduals <- residuals(tasteVsAcetic)
plot(cheese[, "h2s"], tVsAResiduals, xlab = "H2S", ylab = "TvA Residuals")
plot(cheese[, "lactic"], tVsAResiduals, xlab = "Lactic", ylab = "TvA Residuals")
```

The residuals both have a normal distribution and seem to be positively associated with Lactic and H2S.

## 11.56

```{r}
h2sCol <- as.numeric(cheese[, "h2s"])
tasteVsH2S <- lm(tasteCol ~ h2sCol, data.frame(cheese))
plot(h2sCol, tasteCol, xlab = "H2S", ylab = "Taste")
abline(tasteVsH2S)
```

```{r fig.height=3, fig.width=3.5, fig.show='hold'}
tVsHResiduals <- residuals(tasteVsH2S)
plot(cheese[, "acetic"], tVsHResiduals, xlab = "Acetic", ylab = "TvH2S Residuals")
plot(cheese[, "lactic"], tVsHResiduals, xlab = "Lactic", ylab = "TvH2S Residuals")
```

From the graphs there appears to be no correlation between the residuals and other variables. 

## 11.57

```{r}
lacticCol <- as.numeric(cheese[, "lactic"])
tasteVsLactic <- lm(tasteCol ~ lacticCol, data.frame(cheese))
plot(lacticCol, tasteCol, xlab = "Lactic", ylab = "Taste")
abline(tasteVsLactic)
```

```{r fig.height=3, fig.width=3.5, fig.show='hold'}
tVsLResiduals <- residuals(tasteVsLactic)
plot(cheese[, "acetic"], tVsLResiduals, xlab = "Acetic", ylab = "TvL Residuals")
plot(cheese[, "h2s"], tVsLResiduals, xlab = "H2S", ylab = "TvL Residuals")
```

Again, there appears to be no correlation between the residuals and the other variables.

## 11.58

```{r results="asis"}
tVsASum <- summary(tasteVsAcetic)
tVsHSum <- summary(tasteVsH2S)
tVsLSum <- summary(tasteVsLactic)

fStats  <- c(tVsASum$fstatistic[1], tVsHSum$fstatistic[1], tVsLSum$fstatistic[1])
pVals   <- c(tVsASum$coefficients[, 4][2], tVsHSum$coefficients[, 4][2],
             tVsLSum$coefficients[, 4][2])
rSqVals <- c(tVsASum$r.squared, tVsHSum$r.squared, tVsLSum$r.squared)
sdEst   <- c(tVsASum$sigma, tVsHSum$sigma, tVsLSum$sigma)

knitr::kable(data.frame(
  fStats, pVals, rSqVals, sdEst
))

# regression equations
printEq <- function(funcSum, name) {
  cat("Taste vs", name, funcSum$coefficients[, 3][1], "+", name, "*", funcSum$coefficients[, 3][2], "\n") 
}
```

```{r}
printEq(tVsASum, "Acetic")
printEq(tVsHSum, "H2S")
printEq(tVsLSum, "Lactic")
```

The intercepts in the three equations are different because the explanitory variables all have different values, leading to the points being plotted in different places. Since the linear equations are estimating the best fit line for these datapoints, it is only natural that the differing data produces different intercepts.

## 11.59

```{r}
tasteVsAnH <- lm(tasteCol ~ aceticCol+h2sCol, data.frame(cheese))
summary(tasteVsAnH)
```
Taste^ = -26.94 + 3.801*acetic + 5.146*h2s

There is not much statistical significance of Acetic in this model, this loss in (Acetic) significance from the prior model, which used Acetic as the sole predictor, is most likely caused by the large positive correlation between H2S and Acetic. When Acetic is used to predict Taste in conjunction with H2S, there is not much significant information contributed by Acetic that H2S hasn't already done better. 

Between using Acetic and H2S as a predictor model and using Acetic as the lone predictor model, I would prefer using the Acetic and H2S as a predictor model, due to its much larger overall significance level (7.635*10^-6)


## 11.60

```{r}
THLModel <- lm(tasteCol ~ (h2sCol + lacticCol), data.frame(cheese))
THLSum   <- summary(THLModel)

cat("Regression Equation for H2S and Lactic:",
    THLSum$coefficients[, 3][1], "+", "H2s+Lactic *", THLSum$coefficients[, 3][2], "\n")

lmp <- function(fStats) {
  return (pf(fStats[1], fStats[2], fStats[3], lower.tail = F))
}

cat("P-Value:", lmp(THLSum$fstatistic), "\n")
```

Since the p-value of the model with both variables is far less than the p-values of the variables by themselves, it is a much better fit for predicting cheese taste.

## 11.61

```{r}
tasteVall <- lm(tasteCol ~ (h2sCol + lacticCol +aceticCol), data.frame(cheese))
summary(tasteVall)
summary(tasteVsHplusL)
```

Of all the Model's computed